<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VR/XR Scenes App</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-curved-text-component/dist/aframe-curved-text-component.min.js"></script>

    <script>
    // Add click handlers for each circle to open a different site
    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('circle-1').addEventListener('click', function () {
        window.open('https://example.com/1', '_blank');
        });
        document.getElementById('circle-2').addEventListener('click', function () {
        window.open('https://example.com/2', '_blank');
        });
        document.getElementById('circle-3').addEventListener('click', function () {
        window.open('https://example.com/3', '_blank');
        });
        document.getElementById('circle-4').addEventListener('click', function () {
        window.open('https://example.com/4', '_blank');
        });
    });
    </script>

    <!-- Cloud layer component -->
    <script>
        AFRAME.registerComponent('cloud-layer', {
            schema: {
                count: { type: 'number', default: 10 },
                radius: { type: 'number', default: 50 },
                height: { type: 'number', default: 20 },
                yOffset: { type: 'number', default: 0 },
                size: { type: 'vec3', default: { x: 10, y: 5, z: 5 } },
                color: { type: 'color', default: '#ffffff' },
                opacity: { type: 'number', default: 0.7 }
            },

            init: function () {
                const data = this.data;
                const el = this.el;

                for (let i = 0; i < data.count; i++) {
                    const cloud = document.createElement('a-entity');
                    const angle = Math.random() * Math.PI * 2;
                    const distance = Math.random() * data.radius;
                    const x = Math.cos(angle) * distance;
                    const z = Math.sin(angle) * distance;
                    const y = (Math.random() - 0.5) * data.height + data.yOffset;

                    cloud.setAttribute('position', `${x} ${y} ${z + (Math.random() - 0.5) * 0.1}`); // Add a small random z-offset
                    cloud.setAttribute('scale', `${data.size.x + Math.random() * 15} ${data.size.y + Math.random() * 10} ${data.size.z + Math.random() * 15}`);
                    // Create multiple dodecahedrons for a more complex cloud shape
                    const numParts = Math.floor(3 + Math.random() * 3); // 3 to 5 parts per cloud
                    for (let j = 0; j < numParts; j++) {
                        const cloudPart = document.createElement('a-entity');
                        cloudPart.setAttribute('geometry', 'primitive: dodecahedron; radius: 1;');
                        cloudPart.setAttribute('material', {
                            color: data.color,
                            transparent: true,
                            opacity: (data.opacity * (0.7 + Math.random() * 0.3)) / numParts, // Distribute opacity
                            shader: 'standard',
                            src: '#cloud-texture'
                        });
                        // Randomly offset and scale each part
                        const offsetX = (Math.random() - 0.5) * data.size.x * 0.5;
                        const offsetY = (Math.random() - 0.5) * data.size.y * 0.5;
                        const offsetZ = (Math.random() - 0.5) * data.size.z * 0.5;
                        const partScale = 0.5 + Math.random(); // Scale between 0.5 and 1.5
                        cloudPart.setAttribute('position', `${offsetX} ${offsetY} ${offsetZ}`);
                        cloudPart.setAttribute('scale', `${partScale} ${partScale} ${partScale}`);
                        cloud.appendChild(cloudPart);
                    }

                    // Add subtle animation
                    cloud.setAttribute('animation', {
                        property: 'position',
                        to: { x: x + (Math.random() - 0.5) * 5, y: y + (Math.random() - 0.5), z: z + (Math.random() - 0.5) * 5 },
                        dir: 'alternate',
                        loop: true,
                        dur: 10000 + Math.random() * 10000,
                        easing: 'easeInOutSine'
                    });

                    el.appendChild(cloud);
                }
            }
        });

        // Make clouds slowly rotate around the scene
        AFRAME.registerComponent('cloud-rotation', {
            init: function () {
                this.rotationSpeed = 0.01;
            },
            tick: function () {
                this.el.object3D.rotation.y += this.rotationSpeed * 0.1;
            }
        });

        // Apply rotation to the clouds container
        document.addEventListener('DOMContentLoaded', () => {
            const clouds = document.getElementById('clouds');
            if (clouds) {
                clouds.setAttribute('cloud-rotation', '');
            }
        });
    </script>
    <style>
        #scene-nav {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 10;
            background: rgba(255, 255, 255, 0.8);
            padding: 10px;
            border-radius: 8px;
        }

        #scene-nav button {
            margin: 2px;
            padding: 6px 10px;
            border-radius: 4px;
            border: none;
            background: #4caf50;
            color: #fff;
            cursor: pointer;
        }

        #scene-nav button.active {
            background: #1976d2;
        }

        #island-nav {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 20;
            background: rgba(255, 255, 255, 0.8);
            padding: 10px;
            border-radius: 8px;
        }

        #island-nav button {
            margin: 2px;
            padding: 6px 10px;
            border-radius: 4px;
            border: none;
            background: #007bff;
            color: #fff;
            cursor: pointer;
        }

        #island-nav button.active {
            background: #0056b3;
        }
    </style>
</head>

<body>
    <!-- Camera switcher UI OUTSIDE the scene -->
    <div id="island-nav"
        style="position:absolute;top:10px;right:10px;z-index:20;background:rgba(255,255,255,0.8);padding:10px;border-radius:8px;">
        <button onclick="switchToIsland('main-camera')">Main</button>
        <button onclick="switchToIsland('island2-camera')">Island 2</button>
        <button onclick="switchToIsland('island5-camera')">Island 5</button>
        <button onclick="switchToIsland('island7-camera')">Island 7</button>
    </div>

    <a-scene background="#87CEEB" cursor="rayOrigin: mouse" raycaster="objects: .clickable"
        fog="color: #87CEEB; near: 30; far: 100">
        <!-- Sky and Environment -->
        <a-sky id="sky" src="#sky-texture" radius="100"></a-sky>

        <!-- Assets -->
        <a-assets>
            <!-- Ground Texture -->
            <img id="ground-texture" src="assets/sky/forest.jpg" crossorigin="anonymous" />
            <img id="island7-texture" src="assets/sky/city.jpg" crossorigin="anonymous" />
            <!-- Sky Texture -->
            <img id="sky-texture" src="assets/sky/Sky_Bubbles.jpg" crossorigin="anonymous" />

            <!-- Book Textures -->
            <img id="book-texture" src="assets/images/foxesBread.jpg" crossorigin="anonymous" />
            <img id="alice-texture" src="assets/images/AliceInWonderland.jpg" crossorigin="anonymous" />
            <img id="strawberries-texture" src="assets/images/strawberries.jpg" crossorigin="anonymous" />

            <!-- Cloud Textures -->
            <img id="cloud-texture" src="https://cdn.aframe.io/360-image-gallery-boilerplate/img/cloud.png"
                crossorigin="anonymous" />

            <!-- Video assets -->
            <video id="video1" src="assets/video/Izaura.mp4" preload="auto" crossorigin="anonymous" loop muted
                playsinline></video>
            <video id="video2" src="assets/video/Lullaby.mp4" preload="auto" crossorigin="anonymous" loop muted
                playsinline></video>
            <video id="video3" src="assets/video/Rich.mp4" preload="auto" crossorigin="anonymous" loop muted
                playsinline></video>
            <video id="video4" src="assets/video/SantaBarbara.mp4" preload="auto" crossorigin="anonymous" loop muted
                playsinline></video>
            <video id="video5" src="assets/video/Assa.mp4" preload="auto" crossorigin="anonymous" loop muted
                playsinline></video>
            <video id="video6" src="assets/video/Nomi.mp4" preload="auto" crossorigin="anonymous" loop muted
                playsinline></video>

            <!-- Panorama Gallery Images -->
            <img id="gallery1" src="assets/images/NY.jpg">
            <img id="gallery2" src="assets/images/autumn.jpeg">
            <img id="gallery3" src="assets/images/bowl.jpg">
            <img id="gallery4" src="assets/images/climbing.jpg">
            <img id="gallery5" src="assets/images/fall.jpg">
            <img id="gallery6" src="assets/images/foxesBread.jpg">
            <img id="gallery7" src="assets/images/mushrooms.png">
            <img id="gallery8" src="assets/images/newYear.jpg">
            <img id="gallery9" src="assets/images/paperBoat.jpg">
            <img id="gallery10" src="assets/images/foxesBread.jpg">
            <img id="gallery11" src="assets/images/pies.jpeg">
            <img id="gallery12" src="assets/images/sekret.jpg">
            <img id="gallery13" src="assets/images/shoes.jpg">
            <img id="gallery14" src="assets/images/NYparty.jpg">
            <img id="gallery15" src="assets/images/strawberries.jpg">
            <img id="gallery16" src="assets/images/wounds.jpg">
            <audio id="green-car-music" src="assets/music/green car.m4a" preload="auto"></audio>
            <!-- Add more images as needed -->
        </a-assets>
        <a-entity camera look-controls position="0 1.6 0">
            <a-cursor fuse="true" fuse-timeout="500" raycaster="objects: .clickable"
                material="color: #1976d2; shader: flat">
            </a-cursor>
        </a-entity>

        <!-- Links -->
        <a-entity id="circle-links" position="0 2 5" rotation="0 180 0">
            <a-circle color="#FFC107" radius="0.5" position="-2 0 0" class="clickable" id="circle-1"></a-circle>
            <a-text value="Site 1" align="center" color="#333" position="-2 0.7 0.01" width="2"></a-text>

            <a-circle color="#1976D2" radius="0.5" position="-0.7 0 0" class="clickable" id="circle-2"></a-circle>
            <a-text value="Site 2" align="center" color="#333" position="-0.7 0.7 0.01" width="2"></a-text>

            <a-circle color="#4CAF50" radius="0.5" position="0.7 0 0" class="clickable" id="circle-3"></a-circle>
            <a-text value="Site 3" align="center" color="#333" position="0.7 0.7 0.01" width="2"></a-text>

            <a-circle color="#E91E63" radius="0.5" position="2 0 0" class="clickable" id="circle-4"></a-circle>
            <a-text value="Site 4" align="center" color="#333" position="2 0.7 0.01" width="2"></a-text>
        </a-entity>


        <!-- Roads to Islands -->
        <a-entity id="roads">
            <!-- Road to Island 2 (Curvy) -->
            <a-box position="0.2 0 -2" rotation="0 10 0" width="1" height="0.1" depth="4" color="#696969"></a-box>
            <a-box position="0.8 0 -6" rotation="0 -10 0" width="1" height="0.1" depth="4" color="#696969"></a-box>
            <a-box position="0.5 0 -10" rotation="0 0 0" width="1" height="0.1" depth="4" color="#696969"></a-box>
            <!-- Road between Island 2 and Island 5 -->
            <a-box position="3.5 0 -13.5" rotation="0 -30 0" width="1" height="0.1" depth="6" color="#696969"></a-box>
            <!-- Road between Island 5 and Island 7 -->
            <a-box position="9 0 -22.5" rotation="0 -22 0" width="1" height="0.1" depth="16" color="#696969"></a-box>
        </a-entity>

        <!-- Distant clouds -->
        <a-entity id="clouds" position="0 50 -100">
            <!-- Cloud layer 1 -->
            <a-entity position="-100 0 0"
                cloud-layer="count: 5; radius: 100; height: 30; yOffset: 10; size: 25 6 6; color: #ffffff; opacity: 0.7"></a-entity>
            <!-- Cloud layer 2 -->
            <a-entity position="0 30 0"
                cloud-layer="count: 7; radius: 120; height: 40; yOffset: 10; size: 30 8 8; color: #ffffff; opacity: 0.6"></a-entity>
            <!-- Cloud layer 3 -->
            <a-entity position="50 60 50"
                cloud-layer="count: 25; radius: 140; height: 60; yOffset: 10; size: 40 10 10; color: #ffffff; opacity: 0.7"></a-entity>
        </a-entity>

        <!-- Rotating Bagel -->
        <a-entity id="bagel-container" position="0 5 -12" scale="1 1 1">
            <a-torus id="bagel-torus" radius="0.8" radius-tubular="0.3"
                animation__rotateY="property: rotation; to: 0 360 0; loop: true; dur: 1000"
                animation__rotateX="property: rotation; to: 360 0 0; loop: true; dur: 1500"
                animation__color1="property: material.color; from: #FF6B6B; to: #4ECDC4; loop: true; dur: 1000; dir: alternate"
                material="shader: standard; color: #FF6B6B; metalness: 0.2; roughness: 0.5; transparent: true"></a-torus>
        </a-entity>

        <!-- Island 2 - Books, Cat, and Flower -->
        <a-entity position="1 0 -12">
            <a-circle radius="1.5" rotation="-90 0 0" class="clickable island" data-camera="island2-camera"
                material="shader: standard; src: #strawberries-texture"></a-circle>
            <!-- Chess Model -->
            <a-gltf-model src="assets/objects/chess_polycam_glb.glb" position="0 0 0" scale="1 1 1"></a-gltf-model>
        </a-entity>

        <!-- Table for Island 2 -->
        <a-gltf-model src="assets/objects/table.glb" position="1 0.5 -12" scale="0.016 0.016 0.016"
            rotation="0 30 0"></a-gltf-model>

        <!-- Cat on the table -->
        <a-gltf-model id="cat-on-island2" class="clickable" src="assets/objects/cat.glb" position="1 0.5 -12"
            scale="0.016 0.016 0.016" rotation="-90 0 0">
        </a-gltf-model>
        <a-text value="Click Me!" position="1 0.8 -11.6" align="center" color="#1976d2" width="5"></a-text>

        <!-- Alice in Wonderland Book -->
        <a-entity position="1 0.5 -12" rotation="0 0 15">
            <a-box src="#alice-texture" depth="0.08" height="0.5" width="0.4" position="0 0 0"
                material="shader: standard; metalness: 0.1; roughness: 0.8">
            </a-box>
        </a-entity>

        <!-- Books -->
        <a-gltf-model src="assets/objects/book.glb" position="1 0.5 -12" scale="0.016 0.016 0.016"
            rotation="0 30 0"></a-gltf-model>
        <a-gltf-model src="assets/objects/pinwheel.glb" position="1 0.5 -12" scale="0.016 0.016 0.016"
            rotation="90 90 90" class="clickable" id="flower-model"></a-gltf-model>

        <!-- Island 5 -->
        <a-entity position="6 0 -15">
            <a-circle radius="2" color="#e8f5e9" rotation="-90 0 0" class="clickable island"
                data-camera="island5-camera" material="src: #ground-texture; repeat: 1 1; shader: flat">
            </a-circle>
        </a-entity>
        <a-gltf-model src="assets/objects/kayak.glb" position="7.5 0.3 -14.5" rotation="0 45 0"
            scale="0.7 0.7 0.7"></a-gltf-model>
        <a-gltf-model src="assets/objects/camping_tent.glb" position="6 0.3 -15.5" scale="0.8 0.8 0.8"></a-gltf-model>
        <!-- Link to Island 5 Tent Scene -->
        <a-entity position="6 0.5 -14.8">
            <a-plane width="0.5" height="0.25" color="#4CAF50" class="clickable" id="tent-entrance">
                <a-text value="Enter Tent" align="center" color="#fff" width="2"></a-text>
            </a-plane>
        </a-entity>

        <script>
            document.querySelector('#tent-entrance').addEventListener('click', function () {
                window.location.href = 'island5-tent-scene.html';
            });
        </script>

        <!-- Media player bubbles on island 5 -->
        <a-entity position="6 1.5 -15">
            <!-- Play circle -->
            <a-circle color="#FFC107" radius="0.15" position="-0.25 0 0.01" class="clickable" id="play-bubble">
                <a-text value="play" align="center" color="#fff" position="0 0 0.08" width="2" side="double"></a-text>
            </a-circle>
            <!-- Pause circle -->
            <a-circle color="#1976D2" radius="0.15" position="0.25 0 0.01" class="clickable" id="pause-bubble">
                <a-text value="stop" align="center" color="#fff" position="0 0 0.08" width="2" side="double"></a-text>
            </a-circle>
            <audio id="laforet-audio" src="assets/music/Laforet.m4a"></audio>
        </a-entity>

        <!-- Island 7: move TV, screen, and chair here -->
        <a-entity position="12 0 -30">
            <a-circle radius="2" color="#f3e5f5" rotation="-90 0 0" class="clickable island"
                data-camera="island7-camera" material="src: #island7-texture; repeat: 1 1; shader: flat">
            </a-circle>
        </a-entity>
        <a-gltf-model src="assets/objects/tv.glb" position="12 1 -30.5" rotation="0 0 0" scale="4 4 4"></a-gltf-model>
        <!-- TV Screen -->
        <a-video id="tv-screen" src="#video1" position="12 1 -29.98" width="1.1" height="0.9" rotation="0 0 0"
            material="shader: flat" autoplay loop muted>
        </a-video>

        <!-- Book on Island 7 -->
        <a-entity position="13 0.5 -30"
            animation="property: rotation; to: 0 360 15; loop: true; dur: 20000; easing: linear">
            <a-box src="#book-texture" depth="0.1" height="0.7" width="0.5" position="0 0 0"
                material="shader: standard; metalness: 0.1; roughness: 0.8">
            </a-box>
        </a-entity>

        <!-- Teddy Bear on Island 7 -->
        <a-gltf-model src="assets/objects/teddybear_toy.glb" position="13 0.3 -29.5" scale="0.001 0.001 0.001"
            rotation="0 0 0">
        </a-gltf-model>

        <!-- TV Controls -->
        <a-entity position="12 1.8 -30.02" rotation="0 0 0">
            <a-plane color="#333" width="1.2" height="0.2" position="-0.1 0 0"
                material="shader: flat; opacity: 0.9"></a-plane>

            <!-- Channel Buttons -->
            <a-entity position="0 0 0.005">
                <!-- Channel 1 -->
                <a-entity position="-0.6 0 0.01" class="clickable channel-btn channel-1" data-channel="1"
                    cursor="rayOrigin: mouse" raycaster="objects: .channel-1"
                    geometry="primitive: plane; width: 0.1; height: 0.1"
                    material="color: #FF5252; opacity: 0.01; transparent: true"
                    animation__mouseenter="property: scale; to: 1.8 1.8 1; dur: 150; startEvents: mouseenter"
                    animation__mouseleave="property: scale; to: 1 1 1; dur: 150; startEvents: mouseleave">
                    <a-circle radius="0.03" color="#FF5252" scale="1.5 1.5 1" material="shader: flat"
                        animation__scale="property: scale; to: 1.8 1.8 1; dur: 150; startEvents: mouseenter; pauseEvents: mouseleave">
                    </a-circle>
                    <a-text value="1" color="white" align="center" position="0 0 0.005" scale="0.4 0.4 1"></a-text>
                </a-entity>

                <!-- Channel 2 -->
                <a-entity position="-0.4 0 0.01" class="clickable channel-btn channel-2" data-channel="2"
                    cursor="rayOrigin: mouse" raycaster="objects: .channel-2"
                    geometry="primitive: plane; width: 0.1; height: 0.1"
                    material="color: #4CAF50; opacity: 0.01; transparent: true"
                    animation__mouseenter="property: scale; to: 1.8 1.8 1; dur: 150; startEvents: mouseenter"
                    animation__mouseleave="property: scale; to: 1 1 1; dur: 150; startEvents: mouseleave">
                    <a-circle radius="0.03" color="#4CAF50" scale="1.5 1.5 1" material="shader: flat"
                        animation__scale="property: scale; to: 1.8 1.8 1; dur: 150; startEvents: mouseenter; pauseEvents: mouseleave">
                    </a-circle>
                    <a-text value="2" color="white" align="center" position="0 0 0.005" scale="0.4 0.4 1"></a-text>
                </a-entity>

                <!-- Channel 3 -->
                <a-entity position="-0.2 0 0.01" class="clickable channel-btn channel-3" data-channel="3"
                    cursor="rayOrigin: mouse" raycaster="objects: .channel-3"
                    geometry="primitive: plane; width: 0.1; height: 0.1"
                    material="color: #2196F3; opacity: 0.01; transparent: true"
                    animation__mouseenter="property: scale; to: 1.8 1.8 1; dur: 150; startEvents: mouseenter"
                    animation__mouseleave="property: scale; to: 1 1 1; dur: 150; startEvents: mouseleave">
                    <a-circle radius="0.03" color="#2196F3" scale="1.5 1.5 1" material="shader: flat"
                        animation__scale="property: scale; to: 1.8 1.8 1; dur: 150; startEvents: mouseenter; pauseEvents: mouseleave">
                    </a-circle>
                    <a-text value="3" color="white" align="center" position="0 0 0.005" scale="0.4 0.4 1"></a-text>
                </a-entity>

                <!-- Channel 4 -->
                <a-entity position="0.0 0 0.01" class="clickable channel-btn channel-4" data-channel="4"
                    cursor="rayOrigin: mouse" raycaster="objects: .channel-4"
                    geometry="primitive: plane; width: 0.1; height: 0.1"
                    material="color: #FFC107; opacity: 0.01; transparent: true"
                    animation__mouseenter="property: scale; to: 1.8 1.8 1; dur: 150; startEvents: mouseenter"
                    animation__mouseleave="property: scale; to: 1 1 1; dur: 150; startEvents: mouseleave">
                    <a-circle radius="0.03" color="#FFC107" scale="1.5 1.5 1" material="shader: flat"
                        animation__scale="property: scale; to: 1.8 1.8 1; dur: 150; startEvents: mouseenter; pauseEvents: mouseleave">
                    </a-circle>
                    <a-text value="4" color="white" align="center" position="0 0 0.005" scale="0.4 0.4 1"></a-text>
                </a-entity>

                <!-- Channel 5 -->
                <a-entity position="0.2 0 0.01" class="clickable channel-btn channel-5" data-channel="5"
                    cursor="rayOrigin: mouse" raycaster="objects: .channel-5"
                    geometry="primitive: plane; width: 0.1; height: 0.1"
                    material="color: #9C27B0; opacity: 0.01; transparent: true"
                    animation__mouseenter="property: scale; to: 1.8 1.8 1; dur: 150; startEvents: mouseenter"
                    animation__mouseleave="property: scale; to: 1 1 1; dur: 150; startEvents: mouseleave">
                    <a-circle radius="0.03" color="#9C27B0" scale="1.5 1.5 1" material="shader: flat"
                        animation__scale="property: scale; to: 1.8 1.8 1; dur: 150; startEvents: mouseenter; pauseEvents: mouseleave">
                    </a-circle>
                    <a-text value="5" color="white" align="center" position="0 0 0.005" scale="0.4 0.4 1"></a-text>
                </a-entity>

                <!-- Channel 6 -->
                <a-entity position="0.4 0 0.01" class="clickable channel-btn channel-6" data-channel="6"
                    cursor="rayOrigin: mouse" raycaster="objects: .channel-6"
                    geometry="primitive: plane; width: 0.1; height: 0.1"
                    material="color: #FF9800; opacity: 0.01; transparent: true"
                    animation__mouseenter="property: scale; to: 1.8 1.8 1; dur: 150; startEvents: mouseenter"
                    animation__mouseleave="property: scale; to: 1 1 1; dur: 150; startEvents: mouseleave">
                    <a-circle radius="0.03" color="#FF9800" scale="1.5 1.5 1" material="shader: flat"
                        animation__scale="property: scale; to: 1.8 1.8 1; dur: 150; startEvents: mouseenter; pauseEvents: mouseleave">
                    </a-circle>
                    <a-text value="6" color="white" align="center" position="0 0 0.005" scale="0.4 0.4 1"></a-text>
                </a-entity>
            </a-entity>

            <!-- Sound Toggle Button -->
            <a-entity position="0.6 0.2 0.005">
                <a-entity id="sound-toggle-btn" position="0 0 0.01" class="clickable sound-toggle"
                    cursor="rayOrigin: mouse" raycaster="objects: .sound-toggle"
                    geometry="primitive: plane; width: 0.15; height: 0.08"
                    material="color: #9C27B0; opacity: 0.01; transparent: true"
                    animation__mouseenter="property: scale; to: 1.2 1.2 1; dur: 150; startEvents: mouseenter"
                    animation__mouseleave="property: scale; to: 1 1 1; dur: 150; startEvents: mouseleave">
                    <a-box width="0.12" height="0.06" depth="0.01" color="#9C27B0" material="shader: flat"
                        animation__scale="property: scale; to: 1.2 1.2 1; dur: 150; startEvents: mouseenter; pauseEvents: mouseleave">
                    </a-box>
                    <a-text id="sound-btn-text" value="ðŸ”‡ MUTED" color="white" align="center" position="0 0 0.01"
                        scale="0.3 0.3 1"></a-text>
                </a-entity>
            </a-entity>
        </a-entity>
        <a-gltf-model src="assets/objects/chair.glb" position="12 0.5 -28" scale="1 1 1"
            rotation="0 180 0"></a-gltf-model>

        <!-- Add this camera entity for a fixed view at island 7 (TV/chair) -->
        <a-entity id="island7-camera" camera look-controls wasd-controls position="12 1.6 -26" rotation="0 -20 0"
            visible="false">
        </a-entity>

        <!-- Camera entities for each island -->
        <!-- Main camera at the start of the road -->
        <a-entity id="main-camera" camera look-controls wasd-controls position="0 1.6 0" rotation="0 0 0"
            visible="true">
            <a-cursor fuse="true" fuse-timeout="500" raycaster="objects: .clickable"
                material="color: #1976d2; shader: flat">
            </a-cursor>
        </a-entity>

        <!-- Island cameras -->
        <a-entity id="island1-camera" camera look-controls position="-3 1.6 -5" rotation="0 0 0" visible="false">
            <a-cursor fuse="true" fuse-timeout="500" raycaster="objects: .clickable"
                material="color: #1976d2; shader: flat"></a-cursor>
        </a-entity>

        <a-entity id="island2-camera" camera look-controls position="3 1.6 -10" rotation="0 0 0" visible="false">
            <a-cursor fuse="true" fuse-timeout="500" raycaster="objects: .clickable"
                material="color: #1976d2; shader: flat"></a-cursor>
        </a-entity>

        <a-entity id="island3-camera" camera look-controls position="-6 1.6 -13" rotation="0 0 0" visible="false">
            <a-cursor fuse="true" fuse-timeout="500" raycaster="objects: .clickable"
                material="color: #1976d2; shader: flat"></a-cursor>
        </a-entity>

        <a-entity id="island5-camera" camera look-controls position="6 1.6 -13" rotation="0 0 0" visible="false">
            <a-cursor fuse="true" fuse-timeout="500" raycaster="objects: .clickable"
                material="color: #1976d2; shader: flat"></a-cursor>
        </a-entity>

        <a-entity id="island6-camera" camera look-controls position="-8 1.6 -23" rotation="0 0 0" visible="false">
            <a-cursor fuse="true" fuse-timeout="500" raycaster="objects: .clickable"
                material="color: #1976d2; shader: flat"></a-cursor>
        </a-entity>

        <a-entity id="island7-camera" camera look-controls wasd-controls position="12 1.6 -26" rotation="0 -20 0"
            visible="false">
            <a-cursor fuse="true" fuse-timeout="500" raycaster="objects: .clickable"
                material="color: #1976d2; shader: flat"></a-cursor>
        </a-entity>

        <!-- Gallery that surrounds the camera -->
        <a-entity id="gallery-rig">
            <a-entity id="gallery-container" position="0 0 0">
                <!-- Gallery planes will be added here -->
            </a-entity>
        </a-entity>

        <!-- Popup text -->
        <a-entity id="popup" position="0 1.6 -1.5" scale="0 0 0" visible="false">
            <a-plane color="#212F3D" opacity="0.9" width="2.2" height="0.5" position="0 0 0"></a-plane>
            <a-plane color="#3498DB" width="2.3" height="0.6" position="0 0 0.001"></a-plane>
            <a-text id="popup-text" value="" color="white" align="center" width="2" position="0 0 0.005"></a-text>
        </a-entity>

        <script>
            // Gallery data with image sources and descriptions
            const galleryData = [
                { id: "#gallery1", ratio: 1.5, title: "New York Memories", description: "A beautiful day in the city" },
                { id: "#gallery2", ratio: 1.6, title: "Autumn Colors", description: "Leaves changing in the park" },
                { id: "#gallery3", ratio: 1.3, title: "Morning Bowl", description: "Breakfast time" },
                { id: "#gallery4", ratio: 1.4, title: "Mountain Climb", description: "Reaching new heights" },
                { id: "#gallery5", ratio: 1.5, title: "Fall Foliage", description: "Colors of the season" },
                { id: "#gallery6", ratio: 1.7, title: "Foxes in the Snow", description: "Winter wildlife" },
                { id: "#gallery7", ratio: 1.2, title: "Forest Mushrooms", description: "Nature's wonders" },
                { id: "#gallery8", ratio: 1.5, title: "New Year's Eve", description: "Celebration time" },
                { id: "#gallery9", ratio: 1.6, title: "Paper Boat", description: "Childhood memories" },
                { id: "#gallery10", ratio: 1.3, title: "Fox Family", description: "In their natural habitat" },
                { id: "#gallery11", ratio: 1.4, title: "Homemade Pies", description: "Grandma's recipe" },
                { id: "#gallery12", ratio: 1.5, title: "Hidden Spot", description: "Our secret place" },
                { id: "#gallery13", ratio: 1.7, title: "Old Shoes", description: "Miles of memories" },
                { id: "#gallery14", ratio: 1.2, title: "NYE Party", description: "Celebrating together" },
                { id: "#gallery15", ratio: 1.5, title: "Summer Berries", description: "Sweet harvest" },
                { id: "#gallery16", ratio: 1.6, title: "Childhood Scars", description: "Stories to tell" }
            ];

            // Gallery parameters
            const radius = 45; // Larger radius for the gallery circle
            const planeHeight = 4; // Larger images
            const centerY = 5.0; // Camera height
            const ROTATION_SPEED = 0.0005; // Very slow rotation speed
            let galleryAngle = 0;
            let currentCenter = new THREE.Vector3();
            let galleryContainer = document.getElementById('gallery-container');
            let popup = document.getElementById('popup');
            let popupText = document.getElementById('popup-text');

            // Create gallery planes
            galleryData.forEach((img, i) => {
                const theta = (i / galleryData.length) * Math.PI * 2;
                const x = Math.cos(theta) * radius;
                const z = Math.sin(theta) * radius;
                const width = planeHeight * img.ratio;

                // Position the plane to face the center (camera)
                const angle = Math.atan2(z, x) * (180 / Math.PI);

                // Position relative to current camera position
                const worldX = x; // Already relative to center
                const worldZ = z; // Already relative to center

                const plane = document.createElement('a-plane');
                plane.setAttribute('src', img.id);
                plane.setAttribute('width', width);
                plane.setAttribute('height', planeHeight);
                plane.setAttribute('color', '#fff');
                plane.setAttribute('material', 'side:double; transparent: true; opacity: 0.9');
                plane.setAttribute('position', `${worldX} ${centerY} ${worldZ}`);
                plane.setAttribute('rotation', `0 ${angle + 180} 0`);
                plane.setAttribute('look-at', '[camera]');
                plane.classList.add('clickable', 'gallery-item');
                plane.setAttribute('data-title', img.title);
                plane.setAttribute('data-description', img.description);

                // Add hover effect
                plane.addEventListener('mouseenter', function () {
                    this.setAttribute('scale', '1.1 1.1 1.1');
                });

                plane.addEventListener('mouseleave', function () {
                    this.setAttribute('scale', '1 1 1');
                });

                // Add click handler for displaying text on the image
                plane.addEventListener('click', function () {
                    const title = this.getAttribute('data-title');
                    const desc = this.getAttribute('data-description');
                    const textContent = `${title}\n${desc}`;

                    // Remove any existing text from previous clicks on this plane
                    const existingText = this.querySelector('.gallery-text');
                    if (existingText) {
                        this.removeChild(existingText);
                    }

                    // Create new text element
                    const textElement = document.createElement('a-text');
                    textElement.setAttribute('value', textContent);
                    textElement.setAttribute('position', `0 0 ${0.05}`); // Slightly in front of the plane
                    textElement.setAttribute('align', 'center');
                    textElement.setAttribute('color', '#FFF'); // White text for contrast
                    textElement.setAttribute('width', this.getAttribute('width') * 4); // Enlarge width to fit plane
                    textElement.setAttribute('wrap-count', 30); // Wrap text if too long
                    textElement.classList.add('gallery-text');

                    this.appendChild(textElement);

                    // Remove text after 5 seconds
                    setTimeout(() => {
                        if (this.contains(textElement)) {
                            this.removeChild(textElement);
                        }
                    }, 5000); // Text disappears after 5 seconds
                });

                galleryContainer.appendChild(plane);
            });

            // Position the gallery around the camera
            const camera = document.querySelector('[camera]');
            const galleryRig = document.getElementById('gallery-rig');
            const scene = document.querySelector('a-scene');

            // Position the gallery rig at the camera's position
            function updateGalleryPosition() {
                if (!camera) return;

                // Get current camera position and update gallery rig
                const cameraPos = camera.getAttribute('position');
                currentCenter.set(cameraPos.x, cameraPos.y, cameraPos.z);

                // Update gallery rig to match camera position exactly
                galleryRig.object3D.position.copy(cameraPos);
                galleryRig.object3D.updateMatrixWorld(true);

                // Make the gallery rotate very slowly
                galleryAngle += ROTATION_SPEED;
                galleryContainer.setAttribute('rotation', `0 ${galleryAngle} 0`);

                // Update all image positions relative to current center and make them face camera
                const images = galleryContainer.querySelectorAll('.gallery-item');
                images.forEach((img, i) => {
                    const theta = (i / images.length) * Math.PI * 2 + galleryAngle;
                    const x = Math.cos(theta) * radius;
                    const z = Math.sin(theta) * radius;

                    img.setAttribute('position', {
                        x: x,
                        y: centerY - 1,
                        z: z
                    });

                    // Make image face the center
                    img.setAttribute('look-at', '[camera]');
                });

                requestAnimationFrame(updateGalleryPosition);
            }

            // Start the gallery animation once the scene is loaded
            if (scene.hasLoaded) {
                updateGalleryPosition();
            } else {
                scene.addEventListener('loaded', updateGalleryPosition);
            }

            // Add event listeners for play/stop buttons and TV channels
            document.addEventListener('DOMContentLoaded', function () {
                // Audio player controls
                const playButton = document.getElementById('play-bubble');
                const pauseButton = document.getElementById('pause-bubble');
                const audio = document.getElementById('laforet-audio');

                if (playButton && pauseButton && audio) {
                    playButton.addEventListener('click', function (e) {
                        e.stopPropagation();
                        audio.play().catch(error => {
                            console.error('Error playing audio:', error);
                        });
                    });

                    pauseButton.addEventListener('click', function (e) {
                        e.stopPropagation();
                        audio.pause();
                        audio.currentTime = 0;
                    });
                } else {
                    console.warn('Play/pause buttons or audio element not found');
                }

                // TV controls with channel switching
                const tvScreen = document.getElementById('tv-screen');
                const channelButtons = document.querySelectorAll('.channel-btn');
                let currentChannel = 1;
                const totalChannels = 6; // Update this if you add more channels
                let isMuted = true; // Global sound state

                // Function to switch to a specific channel
                async function switchChannel(channelIndex) {
                    if (channelIndex < 1 || channelIndex > totalChannels) return;

                    console.log(`Attempting to switch to channel ${channelIndex}`);

                    // Update current channel
                    currentChannel = channelIndex;

                    try {
                        // Pause all videos first
                        document.querySelectorAll('video').forEach(v => {
                            v.pause();
                            v.currentTime = 0;
                        });

                        // Get the video element for the selected channel
                        const video = document.getElementById(`video${channelIndex}`);
                        if (!video) {
                            console.error(`Video element for channel ${channelIndex} not found`);
                            return;
                        }

                        // Update TV screen source
                        const videoSrc = video.getAttribute('src');
                        tvScreen.setAttribute('src', `#video${channelIndex}`);

                        // Make sure video is ready
                        video.load();
                        video.muted = isMuted !== undefined ? isMuted : true;

                        // Small delay to ensure video is ready
                        await new Promise(resolve => setTimeout(resolve, 100));

                        // Play the selected video
                        const playPromise = video.play();

                        if (playPromise !== undefined) {
                            playPromise.catch(error => {
                                console.error('Error playing video:', error);
                                // Try again with a small delay
                                setTimeout(() => video.play().catch(e => console.error('Retry failed:', e)), 300);
                            });
                        }

                        console.log(`Successfully switched to channel ${channelIndex}`);
                    } catch (error) {
                        console.error(`Error switching to channel ${channelIndex}:`, error);
                    }
                }

                if (tvScreen && channelButtons.length > 0) {
                    console.log('Initializing TV controls...');
                    console.log(`Found ${channelButtons.length} channel buttons`);

                    // Preload all videos but don't autoplay them
                    document.querySelectorAll('video').forEach((video, index) => {
                        console.log(`Preparing video ${index + 1}...`);
                        video.preload = 'auto';
                        video.playsInline = true;
                        video.muted = true;
                        video.loop = true;
                        video.autoplay = false; // Explicitly disable autoplay

                        // Pause any video that might be playing
                        video.pause();

                        // Add event listeners for debugging
                        video.addEventListener('play', () => console.log(`Video ${index + 1} started playing`));
                        video.addEventListener('error', (e) => console.error(`Video ${index + 1} error:`, e.target.error));
                    });

                    // Initialize with first channel after a short delay
                    setTimeout(() => {
                        console.log('Initializing first channel...');
                        switchChannel(1);
                    }, 1000);

                    // Add click handlers for channel buttons
                    channelButtons.forEach((button, index) => {
                        const channelIndex = index + 1;
                        console.log(`Setting up button for channel ${channelIndex}`, button);

                        // Add click listener directly without cloning
                        button.addEventListener('click', function (e) {
                            console.log(`Channel button ${channelIndex} clicked`, e);
                            e.stopPropagation();
                            e.preventDefault();
                            switchChannel(channelIndex);
                            return false;
                        });

                        // Make sure it's interactive with unique targeting
                        button.classList.add('clickable', `channel-${channelIndex}`);
                        button.setAttribute('cursor', 'rayOrigin: mouse');
                        button.setAttribute('raycaster', `objects: .channel-${channelIndex}`);

                        // Add debug outline
                        const circle = button.querySelector('a-circle');
                        if (circle) {
                            circle.setAttribute('material', 'wireframe: true; color: red');
                        }
                    });

                    // Sound toggle functionality
                    function toggleSound() {
                        isMuted = !isMuted;

                        // Update all videos
                        document.querySelectorAll('video').forEach(video => {
                            video.muted = isMuted;
                        });

                        // Update button text and appearance - get fresh reference
                        const currentSoundBtnText = document.getElementById('sound-btn-text');
                        const currentSoundToggleBtn = document.getElementById('sound-toggle-btn');

                        if (currentSoundBtnText && currentSoundToggleBtn) {
                            if (isMuted) {
                                currentSoundBtnText.setAttribute('value', 'ðŸ”‡ MUTED');
                                currentSoundToggleBtn.querySelector('a-box').setAttribute('color', '#9C27B0');
                            } else {
                                currentSoundBtnText.setAttribute('value', 'ðŸ”Š SOUND ON');
                                currentSoundToggleBtn.querySelector('a-box').setAttribute('color', '#4CAF50');
                            }
                        }

                        console.log(`Sound ${isMuted ? 'muted' : 'unmuted'}`);
                    }

                    // Add click handler for sound toggle button
                    const soundToggleBtn = document.getElementById('sound-toggle-btn');
                    if (soundToggleBtn) {
                        // Remove any existing listeners first
                        soundToggleBtn.replaceWith(soundToggleBtn.cloneNode(true));
                        const newSoundBtn = document.getElementById('sound-toggle-btn');

                        newSoundBtn.addEventListener('click', function (e) {
                            console.log('Sound toggle button clicked');
                            e.stopPropagation();
                            e.preventDefault();
                            toggleSound();
                            return false;
                        });

                        // Make sure it's interactive with a unique class
                        newSoundBtn.classList.add('sound-toggle');
                        newSoundBtn.setAttribute('cursor', 'rayOrigin: mouse');
                        newSoundBtn.setAttribute('raycaster', 'objects: .sound-toggle');
                    }
                }
            });
        </script>
        <script>
            // Remove the old bagel island and text entity from your scene if present!

            // Bagel rotation (opposite direction to gallery)
            let bagelAngle = 0;
            function rotateBagel() {
                bagelAngle -= 0.1; // Opposite direction to gallery
                const bagel = document.getElementById('bagel-torus');
                if (bagel) bagel.setAttribute('rotation', `0 ${bagelAngle} 0`);
                // Also rotate the text entity to match the bagel
                const bagelText = document.querySelector('[curved-text]');
                if (bagelText) bagelText.parentEl.setAttribute('rotation', `0 ${bagelAngle} 0`);
                requestAnimationFrame(rotateBagel);
            }
            rotateBagel();
        </script>
        <!-- Ground -->
        <a-entity position="0 -0.05 0">
            <script>
                // Play music when cat is clicked
                const catEntity = document.querySelector('#cat-on-island2');
                if (catEntity) {
                    catEntity.addEventListener('click', function () {
                        const music = document.querySelector('#green-car-music');
                        if (music) {
                            if (music.paused) {
                                music.currentTime = 12.5;
                                music.play();
                            } else {
                                music.pause();
                            }
                        }
                    });
                }
            </script>
        </a-entity>
    </a-scene>

    <!-- Fix for camera switcher buttons not working -->

    <!-- 1. Remove duplicate island7-camera entities! Only keep one with your desired position/rotation. -->
    <!-- 2. Make sure all camera entities have unique IDs. -->
    <!-- 3. The main camera must have id="main-camera" and visible="true" by default. -->
    <!-- 4. The switchToIsland function must be defined in the global scope (outside <a-scene>). -->

    <!-- Example: Place this script just before </body> -->
    <script>
        // Add click handler for islands
        document.addEventListener('DOMContentLoaded', function () {
            // Handle island clicks
            document.querySelectorAll('.island').forEach(island => {
                island.addEventListener('click', function (e) {
                    e.stopPropagation();
                    const cameraId = this.getAttribute('data-camera');
                    if (cameraId) {
                        switchToIsland(cameraId);
                    }
                });
            });

            // Highlight islands on hover
            document.querySelectorAll('.island').forEach(island => {
                island.addEventListener('mouseenter', function () {
                    this.setAttribute('material', 'opacity', '0.8');
                });
                island.addEventListener('mouseleave', function () {
                    this.setAttribute('material', 'opacity', '1');
                });
            });
        });

        function switchToIsland(cameraId) {
            const scene = document.querySelector('a-scene');
            const cameraRig = document.querySelector('#camera-rig') || (() => {
                // Create a camera rig if it doesn't exist
                const rig = document.createElement('a-entity');
                rig.id = 'camera-rig';
                const mainCamera = document.querySelector('[camera]');
                mainCamera.parentNode.insertBefore(rig, mainCamera);
                rig.appendChild(mainCamera);
                return rig;
            })();

            // Get target camera position and rotation
            const targetCam = document.getElementById(cameraId);
            if (!targetCam) return;

            const targetPosition = targetCam.getAttribute('position');
            const targetRotation = targetCam.getAttribute('rotation') || { x: 0, y: 0, z: 0 };

            // Remove any existing animation
            cameraRig.removeAttribute('animation__position');
            cameraRig.removeAttribute('animation__rotation');

            // Add smooth animation to the target position
            cameraRig.setAttribute('animation__position', {
                property: 'position',
                to: `${targetPosition.x} ${targetPosition.y} ${targetPosition.z}`,
                dur: 1000,
                easing: 'easeInOutQuad'
            });

            // Add smooth rotation
            cameraRig.setAttribute('animation__rotation', {
                property: 'rotation',
                to: `0 ${targetRotation.y || 0} 0`,
                dur: 1000,
                easing: 'easeInOutQuad'
            });

            // Update active button
            document.querySelectorAll('#island-nav button').forEach(btn => btn.classList.remove('active'));
            const btn = Array.from(document.querySelectorAll('#island-nav button')).find(b =>
                b.onclick && b.onclick.toString().includes(`'${cameraId}'`)
            );
            if (btn) btn.classList.add('active');
        }

        // Switch to the main camera on page load
        switchToIsland('main-camera');
    </script>
    <script>
        // Bagel fly-away animation
        setTimeout(() => {
            const bagelContainer = document.getElementById('bagel-container');
            if (bagelContainer) {
                // Animate position
                bagelContainer.setAttribute('animation__flyout', {
                    property: 'position',
                    to: '-200 50 -200',
                    dur: 2000,
                    easing: 'easeInQuad'
                });
                
                // Animate opacity
                const bagelTorus = document.getElementById('bagel-torus');
                if (bagelTorus) {
                    bagelTorus.setAttribute('animation__fadeout', {
                        property: 'material.opacity',
                        to: 0,
                        dur: 2000
                    });
                }
            }
        }, 5000); // Wait 5 seconds
    </script>
</body>

</html>